//https://www.spoj.com/problems/KN2/
#include <bits/stdc++.h>
#include <ext/pb_ds/assoc_container.hpp>

using namespace std;
using namespace __gnu_pbds;

#define endl "\n"
#define IOS ios_base::sync_with_stdio(false); cin.tie(nullptr);

using ll = long long;

long long M = 29 * 34483;

long long solve(long long n, long long mod, vector<long long> &trans, vector<long long> &init) {
    if (mod == 1) {
        return 0;
    }
    if (n < 0) {
        return 0;
    }
    int m = trans.size();
    if (n < m) {
        return init[n];
    }
    vector<long long> v(m), u(m << 1);
    long long mask = !!n;
    for (long long m = n; m > 1; m >>= 1) {
        mask <<= 1;
    }
    v[0] = 1;
    for (long long x = 0; mask; mask >>= 1, x <<= 1) {
        fill_n(u.begin(), m * 2, 0);
        x |= !!(n & mask);
        if (x < m) {
            u[x] = 1;
        } else {
            for (int i = 0; i < m; ++i) {
                for (int j = 0, t = i + (x & 1); j < m; ++j, ++t) {
                    u[t] = u[t] + v[i] * v[j];
                }
            }
            for (int i = m * 2 - 1; i >= m; --i) {
                u[i] %= mod;
                for (int j = 0, t = i - m; j < m; ++j, ++t) {
                    u[t] = u[t] + trans[j] * u[i];
                }
            }
            for (int i = 0; i < 2 * m; i++) {
                u[i] %= mod;
            }
        }
        v = {u.begin(), u.begin() + m};
    }
    long long ret = 0;
    for (int i = 0; i < m; ++i) {
        ret = (ret + v[i] * init[i]) % mod;
    }
    return ret;
}

int main() {
    IOS;
    vector<vector<long long>> s(25);
    vector<vector<long long>> c(25);
    c[2] = {8,999993,4,3};
    s[2] = {1,1,5,5};
    c[3] = {32,14,999961,999990,15,3};
    s[3] = {1,1,3,7,27,111};
    c[4] = {999815,320,504,999167,999573,704,183,999770,999967,30,3};
    s[4] = {1,1,3,3,19,55,427,2131,14083,80031,496587};
    c[5] = {993095,11616,23904,962855,969787,43404,17768,976751,994641,6158,899,999194,999926,49,3};
    s[5] = {1,1,3,3,19,39,323,1407,10259,60411,411499,637025,571344,97902,916660};
    c[6] = {86528,94848,267975,386855,482898,554961,603911,974207,450448,502480,322872,335815,970168,178588,788679,970933,27146,2776,998043,999865,72,3};
    s[6] = {1,1,3,3,19,19,283,639,7747,33791,299347,745968,386324,254670,197986,560727,157821,835561,336402,93764,109580,420990};
    c[7] = {543587,593905,932259,306296,284653,660188,589009,372817,393141,519976,419266,540623,356145,564178,595302,453079,383837,414866,159044,107277,827672,893114,87515,6432,996017,999792,99,3};
    s[7] = {1,1,3,3,19,19,283,367,7223,17231,250963,981283,483513,969973,925453,391654,604622,324280,516245,171121,751820,458912,782865,333720,426627,19295,308636,853797};
    c[8] = {232786,202985,630616,237721,188406,289508,495904,692170,288421,814919,882387,507949,186040,984141,599407,63710,439788,141042,902296,711038,909909,76766,735837,740140,310897,351328,698437,524340,885427,353954,687909,228512,12805,992792,999707,130,3};
    s[8] = {1,1,3,3,19,19,283,283,7139,9715,238103,524899,337460,192918,6860,454643,781568,230927,614398,749044,923253,798828,460142,662047,712877,160720,614576,398561,576598,640372,50815,624717,148671,288518,88167,884602,819101};
    c[9] = {630520,409081,799665,71806,143062,103950,819247,170121,521072,699862,40804,617448,214843,270067,655271,764104,196420,160805,994910,709296,263753,842345,469865,33131,970974,343533,45946,431389,706505,485503,47363,790415,376692,543642,437967,843412,288740,337838,222731,515298,22971,987996,999610,165,3};
    s[9] = {1,1,3,3,19,19,283,283,7139,7475,235611,316431,19108,583708,419939,402268,324894,579961,425539,250153,582796,162768,728513,73507,780531,104582,592458,129257,637688,525260,544268,735419,828866,606628,478557,894804,997727,379837,271347,201213,258290,898228,650957,402479,804511};
    c[10] = {174755,150252,514069,261834,561253,998473,849039,80205,43988,116663,852104,258651,108653,262825,641699,700276,185302,218280,948525,117731,264342,999435,120175,861639,316088,778782,293930,996671,853095,798311,123946,860803,684849,308881,264885,165576,846845,899763,388108,478543,163378,134960,994151,846861,988196,579698,170863,822144,602189,284836,44627,38126,981209,999501,204,3};
    s[10] = {1,1,3,3,19,19,283,283,7139,7139,235275,251415,947499,620418,112443,560718,960787,236906,259168,49382,259553,831010,149324,139374,430695,93555,876830,743337,983317,82654,102408,383624,247098,776750,382862,532776,835853,106358,145223,748862,954321,130407,904708,562957,799289,495459,578286,486237,289665,755742,211192,646173,480150,118045,163828,465870};
    c[11] = {832122,312860,667086,654517,64269,704044,244644,88935,283054,225109,688133,837957,243642,58681,946683,111131,565505,556129,335605,805970,185138,30526,47467,624764,516444,155014,876019,263828,239961,609503,950453,282042,415377,11072,749981,393318,228562,107107,964261,869376,491941,91804,653559,133967,865872,198328,550257,796548,755669,530505,428959,168354,97118,94326,800896,554653,17436,397668,78477,563109,953298,59578,971963,999380,247,3};
    s[11] = {1,1,3,3,19,19,283,283,7139,7139,235275,236595,932679,531468,847236,447492,734777,845936,342442,389299,85064,940551,288263,461913,773212,608862,421230,794816,669074,88112,226271,531143,215321,949002,136986,141994,119268,514423,144495,844913,149507,428356,648990,993808,348351,213504,46081,336183,61089,82092,950458,363202,870355,534093,178273,412755,788574,191061,82571,467688,320545,36540,244352,488099,256315,697907};
    c[12] = {78126,257510,395574,91168,494196,6016,783562,617966,372418,782392,138100,687344,606222,322505,371711,764663,495811,171312,640656,454432,181728,234033,131591,885188,49973,751768,712249,686459,907461,249504,347993,78180,69527,945418,649040,340612,730179,397512,137694,331454,827711,9119,136627,299937,999584,946947,440300,267936,720439,844862,975806,618784,691018,128133,988499,69440,906803,702068,971322,701592,794000,94064,506200,477636,700301,359272,350790,69010,782152,498137,684267,407829,32592,151499,881888,408014,33723,310641,862078};
    s[12] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,23972,336308,761326,675775,716707,43191,616754,740041,94935,247191,855038,271327,276223,855320,523233,271748,22340,640850,632255,670831,65784,999727,596607,50391,785940,428748,71204,455376,931884,934601,3028,174073,198536,967858,420634,713262,707056,78973,967403,299221,85267,560187,51619,136413,188700,639414,264036,714555,638684,597272,275078,537006,561796,29276,88585,196035,493735,20010,870885,490240,912907,432222,493422,545795,369784,396711};
    c[13] = {190008,286085,171503,938999,342973,751139,400003,973624,314493,434791,585636,616994,85652,549768,104783,811041,556963,304905,269985,428989,387379,988437,520915,105785,97284,323210,215620,875277,717399,957931,683697,236929,660168,680816,583755,404854,145501,902148,256783,229175,286531,364753,294434,373457,236992,474743,79972,236735,589597,740020,502506,773775,807760,211938,43956,786181,980744,64239,940630,769467,986101,277401,826659,87790,589501,173052,924594,860140,119593,459538,979455,7419,100171,280027,818904,211569,704395,254019,679864,606912,237445,849583,215058,461264,856754,712517,127325,943982,999102,345,3};
    s[13] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,936507,248836,392948,167257,664324,898056,799414,715666,926245,89725,610283,85283,354329,239686,5328,698139,147994,638080,32717,233999,470307,532132,835281,813731,453642,310369,64582,50754,499715,650733,542468,330424,164134,243059,757305,359895,540118,116800,836294,762567,860464,333110,940272,189388,142169,163059,204246,749003,48267,792370,741475,652423,896224,694910,153652,247143,415806,207550,657928,292549,604284,276890,560936,507133,728222,365554,215617,976548,477213,802853,832891,457977,849307,519015,604658,801080,886398,205108};
    c[14] = {605636,647251,734156,868920,779180,798922,682224,112748,665009,28283,578321,90725,364846,668214,390020,660624,767082,299200,237251,795167,980382,256636,504522,216321,972540,946164,917763,897278,904063,182331,473097,464835,37306,739786,801346,170273,360949,116605,840167,575629,174572,675617,895633,117041,914697,691559,999139,471889,319552,821356,451133,557879,189212,209547,538086,504755,335012,924784,472323,341060,145,498065,249293,403673,730073,989441,449751,248178,942762,192545,575665,674310,704095,338001,747480,244966,280903,705387,996558,857267,723266,839367,896208,243038,751831,93465,3181,827511,258197,13763,304874,243499,943046,93328,635606,692138,255275,985643,912620,493671,125315,176956,924071,998945,400,3};
    s[14] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,744188,518497,41180,601603,25093,59059,298896,155254,199547,96590,49583,693292,115333,905855,111604,933570,981019,538142,92900,359815,394007,832688,813624,304728,144719,802929,215216,111216,762870,30209,551836,563580,101421,802977,881857,416289,383403,526968,81719,115989,272021,244984,932493,697044,347973,239794,124811,133279,738735,773472,626564,171932,483468,944220,980811,290144,358316,271840,364945,624834,195503,59999,912996,677294,537860,933843,843498,719464,757581,912780,334098,492176,75376,456412,492085,208278,311571,185761,195139,532776,123493,569049,55972,578041,250870,596502,622125,180043,459561,336315,706309};
    c[15] = {490375,953062,302451,666129,610984,806584,185449,684775,439530,856777,193867,173918,388695,143817,184628,42677,768743,238305,821864,785286,637046,140637,688149,874534,409971,529351,764816,460840,857470,254740,489014,738501,367309,283351,582835,520381,254736,140441,446762,518275,246090,574973,748126,140437,155807,351879,32563,972497,765147,48625,343034,996685,885351,605732,746749,219899,489600,831386,449576,319585,659671,890994,784782,151529,317942,760339,973263,412916,229225,585017,322574,574887,632049,769804,288805,857926,404296,926538,376728,208978,202119,741857,47690,782698,365203,453485,132473,270652,354284,269313,702997,892440,122919,221551,355735,702169,280478,282456,358948,540685,682019,3366,482371,852367,371649,153144,587643,653857,845287,364261,786232,803128,858770,523485,65461,239556,899349,998776,459,3};
    s[15] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,263708,38017,125252,637055,71875,234943,239229,824918,544090,515026,892196,210398,509906,959518,209177,776738,979217,602364,165780,497581,196208,229126,954335,668425,291166,713994,464957,790920,898779,120386,853546,143725,869048,989446,279870,589391,632861,704553,493065,812902,476897,22436,340612,158499,651340,467530,519119,744808,455114,601312,392112,145176,189053,885580,165921,682696,246295,525176,468765,357588,989911,342465,416226,761212,691415,20714,349369,940074,600399,771207,655799,297530,382321,288050,585120,364185,782593,115217,313186,254801,551963,623587,73441,414299,412675,640500,948647,67004,522178,344752,132387,822711,227490,106385,368713,364122,164704,705256,315002,325241,613973,387841,74732,353332,339788};
    c[16] = {80456,478699,960450,390868,592406,552926,313592,611541,278043,878703,353484,204964,56315,603467,829531,326566,220796,664186,726205,621790,80005,874679,688194,84950,703991,383273,860711,388102,659243,216585,951876,466638,698127,795565,204444,21818,446269,953279,350385,611531,704794,796525,643406,736208,169904,42831,397639,325321,695486,291433,939411,797146,610975,422246,4340,184182,303996,818530,581442,846971,854430,762783,104424,994894,547388,524621,800579,535682,314068,981962,242996,924931,938105,148432,53413,648687,492900,712062,757534,572278,889252,408903,932447,138170,30252,902299,54416,376303,690177,106967,734763,438573,147911,731624,578900,708589,515274,448014,988923,808868,250919,856603,623057,601982,439918,165603,667490,25551,760671,434321,748196,600153,660091,627737,631743,762112,64811,60610,975724,574607,95175,496299,325977,306548,487761,189614,61841,685159,51722,834261,679648,28973,317153,869108,998595,522,3};
    s[16] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,243688,17997,606751,118547,164996,607133,213331,697741,430959,457322,592774,387641,109757,44888,986011,216903,963969,97132,225157,94409,588443,787525,379305,393859,428347,704595,479921,888717,553574,582305,683001,36030,439792,443086,701958,980207,697,38599,166450,560067,880936,127950,900700,381964,74203,159013,393330,634471,754583,48903,917979,98885,236287,120295,106169,717902,302729,389668,574110,380485,320429,648260,601829,28319,256608,673519,815665,496073,424838,493791,668541,639236,410899,52422,85084,265077,200311,789431,272923,235962,521782,31205,906491,703514,277786,167966,499870,995780,661730,418134,71819,456211,110302,543724,661008,956448,88776,700629,290899,767556,452599,326105,943039,450212,911770,781506,981723,609285,509454,455318,899651,793691,578490,660388,675757,827885,813459,611581,219777,545702,461640,473430};
    c[17] = {384666,76650,235072,342334,298557,480175,397583,802450,696039,422993,353587,87827,703578,825495,624195,346057,798067,901032,50075,135661,39325,849224,554069,342586,482001,346974,395311,250169,364667,876555,220902,308391,593328,862638,574202,142016,934916,938660,879403,593718,450601,694104,773890,934884,661360,848835,557364,40834,929280,156472,941625,759399,947252,979380,332566,532759,899882,478466,388156,647515,984727,304134,578225,307602,672707,238311,458391,443328,291647,239398,590212,968592,41737,621762,430394,247972,401362,250471,713672,592504,820804,860080,283599,147469,15284,77017,373845,820706,282905,551023,287068,441195,114868,513327,890948,233708,236715,488891,19619,704841,331901,41920,754735,490161,160804,356473,130891,785734,281531,942768,774995,907268,200306,284105,346630,916948,413532,798972,867177,591514,411246,451141,938108,648667,109521,935578,85900,857972,511649,229909,809214,336439,711686,515813,891102,228855,618251,949783,639399,380126,425623,775544,683625,662417,110814,436519,394580,622364,411919,832592,998402,589,3};
    s[17] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,243688,17997,95789,607592,276057,718194,310619,691559,935261,87401,713087,777555,679276,926971,502858,784166,320235,663117,703672,279758,220834,808507,161651,400978,824223,506565,921140,383092,533210,345485,806718,248325,140889,345283,635466,738479,339637,544839,69604,19554,626556,617394,213534,157528,96585,791214,546607,432997,627809,43632,706820,72652,156027,64627,19061,650969,685396,286795,901892,109003,375078,709757,671913,70473,109387,201605,579042,57731,823373,771173,279519,250499,932293,350739,173366,346770,596759,571302,697417,771737,190012,363630,117664,552715,283431,960076,450061,473425,632765,444305,13590,526003,833916,848040,695632,959896,65297,211106,481670,344922,57757,361350,122270,878936,695687,483573,880452,974739,154506,252730,720081,761727,68541,873578,488565,478205,406568,287531,708375,691000,800544,414024,946348,525674,128359,267063,370451,84941,543398,784277,494323,390640,875483,932995,354678,193981,696007,124723};
    c[18] = {286747,435733,813132,454758,89031,320381,506106,317565,801690,500218,995771,160450,892411,385288,891206,903491,301911,541731,168688,800177,610713,231358,690004,654818,585676,697496,391663,604647,312743,62752,493630,154978,16111,15339,138373,612369,774788,902732,61893,322085,53187,603940,476468,300347,595966,156728,150501,563331,156302,448052,633970,979502,245590,720253,640670,181122,405863,455613,738110,619097,526267,511028,879779,174090,554138,67041,666475,627274,447406,279899,471816,268698,125485,909686,953877,602273,779364,692634,482061,108283,695611,160291,39187,204442,832897,811346,124749,862321,409988,932581,121731,848700,362087,474911,571590,645599,280131,872736,497507,909931,943844,445443,149786,682721,141573,325649,320021,102747,7341,658622,369837,131914,944593,470539,474057,29230,922599,702849,188014,270205,991099,115175,315691,632644,890716,722422,955925,761119,76112,239874,370506,524501,383925,331485,736676,515395,637253,574959,831613,432925,679865,739195,376254,764971,551055,511265,116778,210522,754213,881470,352575,616872,913710,608497,453225,176065,940326,255246,397788,267772,344400,83734,427588,493276,303142,756243,577741,526170,788997,998197,660,3};
    s[18] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,243688,17997,17997,529800,482077,924214,96095,771610,842284,579792,308463,863466,199000,810619,263921,26433,564867,979534,36864,958919,903296,782853,233104,1584,676430,769356,919012,304039,879081,157164,440604,611762,7026,412514,468921,93481,16185,961711,974536,361580,665993,232739,568295,306859,254725,292870,84206,201253,754717,424807,216566,107633,546083,767626,533543,639118,236774,587620,585960,225681,205987,824556,963840,832761,673558,873388,51660,26239,931859,920474,426142,553288,921665,350194,332581,944948,378446,294596,251222,120029,52639,747131,490311,844297,708175,821358,881048,230943,792735,824001,456265,357394,171634,977233,526362,666554,725529,449999,818332,778224,123959,524838,881098,935426,424482,814547,735689,355417,729013,879297,188424,28072,706994,157902,610086,867377,265621,425253,614007,38959,73067,550748,314245,23234,327505,726757,289383,208415,655048,331868,357501,190757,18447,935976,523162,55899,464127,918714,930330,233630,560765,667358,67797,810637,474877,900913,857734,545387,836276,517736,609139,390277,80316,692447,818404,298375,216555};
    c[19] = {356154,262728,600940,671722,164006,685276,594921,71051,776830,321207,479416,578566,99073,592915,687925,364568,886230,982278,992704,638539,556925,640303,542498,175518,206937,634154,30788,666755,657936,977981,886442,348613,849559,910732,84211,665396,335035,739272,639740,415724,514778,210955,746966,51346,901306,65812,965825,370198,596766,909659,727624,115188,905507,378037,458402,755611,840938,77000,728986,44228,807183,972762,935609,893776,112282,190129,448184,530821,175232,228775,464771,394966,919517,925659,141345,704626,329975,852564,235037,441169,830457,602660,664761,443649,723734,265508,184858,103874,378514,315999,493813,837469,607297,131206,864680,160974,371272,707491,129488,739807,185557,363772,649442,896716,451266,906041,150213,991445,765477,27389,141739,293601,963876,954721,701562,425736,370174,193471,659364,254365,871343,907634,118092,481323,348481,410472,882184,948995,812930,751335,352944,772602,755259,674150,408699,37015,145598,965157,674370,966104,303259,576654,108086,497030,131678,138659,368977,473055,680475,644094,697765,366159,837593,862160,287846,92849,770346,785392,277228,762501,634374,492700,267399,796098,136080,566919,927086,905980,918635,608531,198812,768003,21947,395466,504560,414711,386249,606309,735530,189249,990824,645379,569593,461793,768913,662366,737471,997980,735,3};
    s[19] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,243688,17997,17997,529800,832128,274258,65962,741477,553369,952330,126809,898120,862814,917177,477307,311277,551538,832087,632894,10903,756155,836045,424264,972294,631440,836484,313366,239439,355208,983078,352566,944017,76711,974068,917443,973310,989572,278326,198317,740938,789086,432199,301582,380698,553587,9399,826322,366629,861049,980508,558177,927768,267361,817824,36055,253604,991456,107709,362787,645952,172868,329070,820064,789065,292709,563350,900261,344334,517694,858138,629639,226384,834456,394758,903634,511751,623378,594204,988533,494082,800591,333681,82751,728548,590244,209368,362717,404809,53736,515174,709124,301287,443901,358749,78979,46323,481902,961730,139618,620138,916321,758584,763564,804651,640840,326951,149439,551064,678970,968239,278095,711567,409073,154425,568219,962654,412756,381895,933607,906013,93222,319871,769683,105186,64163,733674,31140,320980,394326,549577,300862,752406,926174,748818,601283,628212,497932,365600,470702,828415,740638,811685,292439,406336,324182,996771,725742,571846,717043,557049,590532,861091,491167,257261,913142,96125,496483,489649,325789,528590,274114,11582,907440,792869,609531,513101,152864,634805,946129,846074,417053,275291,347460,63280,245389};
    c[20] = {227157,406246,402218,978284,112295,229656,508178,890617,992670,645348,896658,462134,896783,2594,623482,824104,315598,572208,88882,946322,861850,676008,600345,126362,525254,562552,670888,426437,678335,465631,900023,723024,716064,741339,908111,290426,211561,910009,646010,949410,641064,759994,298133,575606,400128,267375,683068,190864,386071,375630,455352,98454,709895,611687,700709,193877,25866,624595,286812,995984,23952,666988,895126,778135,986713,598921,519464,387887,879294,794679,865747,749330,513761,896425,117557,58703,139011,713914,109979,559474,77828,213206,570993,221386,52571,969891,164828,414728,754791,257889,14496,822219,99413,655485,572155,753073,389477,297737,791544,443950,462173,176884,335190,754092,368399,140651,647779,120813,860647,211040,900810,888677,618633,585359,135289,166853,349706,138161,771465,119099,240852,195310,227600,513087,667259,216884,341413,900952,769069,797909,392352,594353,640604,748626,182303,8741,746227,120669,338040,757096,644348,985353,676343,444997,486586,536785,238584,352695,906634,953526,86824,156261,305093,423238,221169,109544,826797,203127,258992,885460,552179,421798,247761,432637,628366,695910,901752,515415,750942,747731,48934,379315,315308,180356,318948,374920,334722,747858,300349,171538,866773,317278,351237,234730,739484,197958,812380,614277,315528,232213,431520,457224,606922,29963,427884,214403,669422,419841,332716,405592,443449,716373,705745,357088,768415,228403,823111,677114,997751,814,3};
    s[20] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,243688,17997,17997,529800,529800,971937,111529,787044,55185,454146,267062,870589,681318,598371,745438,761967,205614,75811,598637,732058,478052,916521,346919,547202,345742,95392,241112,828824,998587,376882,611409,935048,217478,930019,855790,632234,421294,343261,8156,331034,670248,294008,601330,88850,991950,440722,781392,444106,59696,902231,957168,8626,199508,537880,337382,165502,924948,145125,859877,880762,904519,576358,192687,378675,207440,467899,144163,302576,783147,691079,314968,996293,66040,994434,345473,643121,421576,494648,372003,989297,488418,932848,207237,26095,859333,409482,252941,39558,958038,714589,384718,390300,64746,370120,901305,620233,972617,359655,974868,674832,597013,168962,132363,419236,654086,266029,348701,804737,930045,811526,967614,18099,467752,881568,304379,838507,212421,288284,305466,310285,841715,389954,661868,128059,795060,886353,468036,744961,910964,441519,952557,868423,636683,251172,533648,606296,216318,834374,145203,130664,911616,259313,639379,652282,671542,90963,431780,94701,538433,765786,891595,246155,219631,154018,186597,247247,202902,418095,691056,240408,662446,838487,378057,640549,124999,118214,871193,382092,319686,635049,600081,46024,960972,455584,931795,412153,206309,113381,993699,876838,720695,957299,479854,89126,565760,224336,773276,313746,848595,136365,114985,534601,720326,859876,680556,755674};
    c[21] = {680954,771383,361747,562810,375274,634683,578326,231870,289226,804292,560403,742859,106053,183692,291319,956740,310501,590231,265031,623256,427395,658668,582692,975995,661550,240729,462486,676299,567937,293492,870262,737075,758559,282104,89723,674442,810287,945180,312022,769034,40122,561285,255497,772187,389303,982163,778611,689446,109323,600459,649575,508158,745653,538724,489625,965676,112403,484399,360466,480958,630686,745762,136516,371618,584715,751712,225979,181014,573233,855467,684779,632024,797779,272834,502838,102807,385389,330771,75330,984164,18867,113191,363669,877320,280290,727565,703265,824930,178559,540461,520926,233814,907833,968265,531212,447351,863600,326754,674538,976984,206248,212496,656705,114305,311993,764753,755389,14298,923688,36932,461854,22098,846954,225111,521565,766797,552927,27472,13909,716171,585133,61353,200064,262349,193250,941200,702558,349468,874661,425587,536034,621512,574597,272042,957256,603905,259046,949453,438906,83704,875112,629274,921673,679793,255204,941466,755133,50781,303030,897840,649724,663171,418620,295263,93058,618923,14860,607001,211848,308716,673735,532804,761668,734045,97256,421273,390637,235443,329634,410165,136462,669559,447328,395131,247807,673031,201264,590845,928674,976295,372417,676140,701207,837726,413488,149509,208529,964933,205924,686450,83278,301688,603046,523921,527138,588043,745552,878706,874952,123361,490047,950612,259759,472681,906234,11156,868525,638017,661880,469973,34151,96328,986254,370949,707559,588227,632158,92466,287591,194931,841875,112999,600921,813580,441208,165476,11146,606978,997510,897,3};
    s[21] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,243688,17997,17997,529800,529800,971937,147643,823158,689435,88389,928415,131405,534162,739638,156541,209289,42489,269475,659735,509616,655091,489165,982399,196132,421547,709298,312089,785908,396825,4316,623916,638998,887236,839477,674815,617544,809036,417473,963412,645356,40019,19289,156781,881101,898847,742932,891250,768074,536538,269785,441097,512210,901905,787343,724045,578754,300627,692921,571617,360267,304314,294908,228176,372089,309325,713071,221613,980563,7566,367490,724207,719380,831809,571500,665965,264726,201963,941301,729597,958941,460589,576380,182654,680187,966728,167132,832748,507147,377364,179586,628843,311818,769624,653978,8671,537170,119939,867250,698870,205304,645442,869107,896761,655138,306407,376231,551506,277730,765204,39463,971010,137354,376847,22538,246632,608264,645967,661025,267523,112667,526954,462854,441890,496221,273801,502183,420742,238437,602676,190935,502945,83548,806282,911376,825128,634442,826907,300148,812061,34365,918018,287170,794845,126425,449478,542639,733121,420091,30271,836540,201037,455052,431966,960193,486426,533199,609075,371228,346730,634829,264796,915632,101950,566329,831417,510246,460941,583869,163485,875605,21806,355939,224411,567840,158076,38090,672811,379238,438643,10299,334424,788284,288337,267494,583862,182410,890553,506382,570214,834806,41381,562993,900708,998566,636956,292881,388295,133407,614013,807531,261793,715619,604380,236317,830248,778166,759511,249611,383180,568788,285767,671768,782339,350390,176190,638575};
    c[22] = {309829,627682,990618,923294,889062,49200,603048,992533,903704,96454,939063,936410,409725,947161,81245,369621,522731,812184,319269,748247,475789,714801,808895,438559,457520,934185,792734,770881,641863,701627,353226,88633,653683,99898,565539,550131,196165,912389,977407,566110,807487,695031,612865,500240,403256,287423,211412,943698,180594,100056,635006,136970,450735,481797,446667,980080,292588,18301,438043,92406,727605,110319,899393,396982,796387,567231,866617,895659,426705,765687,406314,491821,736853,63959,638745,194296,103176,148170,373082,616203,390516,170659,205756,878283,77856,918220,935138,362859,346195,751065,459378,136971,798299,759139,260798,84425,524762,641616,253261,128327,713425,273711,841796,841843,316662,802564,186917,49242,491235,269568,612310,664297,787142,497701,660173,43141,255597,326777,276634,423065,950352,862034,106973,828067,122916,979481,417024,757418,402501,147153,265923,549979,35569,321397,309612,524735,186395,729597,998293,704515,720226,509890,176633,849937,155015,246761,685192,510020,445847,959275,422956,574729,219973,97114,11388,924693,64581,772420,903532,998700,27784,763999,150635,207754,170396,80951,648940,709307,957533,623918,263195,335589,973940,413762,878345,602449,912148,824057,772309,391983,484502,548895,896556,488216,186393,445015,948028,913597,676431,752742,990209,712499,734908,61038,795374,527619,826451,898793,881170,411483,152920,634234,769494,144740,381903,977841,47510,174958,317777,967196,151242,802622,192043,126593,646541,208476,763352,300020,892827,171197,887462,611749,795410,642278,980390,66353,409058,639962,403918,243435,296921,821600,389838,643397,583819,505691,307735,469565,939828,822724,609569,365927,522248,253323,522603,935829,203762,698260,985078,229377,526067,997257,984,3};
    s[22] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,243688,17997,17997,529800,529800,971937,971937,647445,81851,480812,200249,403246,411606,662690,584634,349713,529421,520534,401492,177442,493986,455439,952298,783124,862455,551148,9090,137856,396397,183705,614948,145878,224473,441952,470189,582333,836471,207070,932039,643899,593998,473021,319995,311086,15994,651218,797299,377834,64780,620522,182592,640123,465707,557612,813023,522476,740202,631193,297485,516724,394237,553430,463244,251699,756355,758720,86066,279045,702050,616759,717632,867209,375412,524160,533288,578085,377488,460033,160430,911,190921,869264,141941,700010,290658,137421,889547,157180,37969,841943,229036,887848,138140,81314,261065,336655,643187,624618,192187,451476,873914,390620,731634,141386,790740,504301,495782,100173,846944,650830,579559,964029,38080,81692,962364,773763,181078,831613,83248,764164,826150,188707,92765,826666,363561,977270,411261,528892,811695,28252,446952,588307,580869,34230,879019,499297,743395,154254,702715,504639,926900,268274,321032,320975,185601,883571,377454,138795,292211,773057,46404,302426,333857,171048,428153,818933,508674,985571,888922,408883,950630,113485,370075,617878,56078,258224,36289,472488,718297,942952,514812,404095,392241,86226,839416,805327,519004,228099,731919,877761,862312,845232,647352,739896,234287,843296,90370,144354,657130,855688,708534,326732,785440,285790,838088,778129,893424,844593,844802,253908,430110,852407,663505,123949,443736,909086,478347,182291,88655,741146,663160,209338,887871,762854,330423,673655,39696,543528,918630,705737,101966,612182,30648,460464,55634,191201,531457,959656,516710,319932,976513,978582,337995,897895,530942,611392,220822,197983,369720};
    c[23] = {884648,937219,595561,174813,458172,681772,153176,282167,537287,60452,80139,594197,846499,292507,193965,556774,844028,177307,773546,631732,837628,890527,642282,587203,114213,953004,368411,32048,300418,74761,674506,392814,139407,930896,754398,382884,136532,192126,588713,356471,857303,633067,829807,270439,859029,259951,357123,117025,463540,99806,7861,221113,501718,763444,256091,779669,469045,244516,322412,951556,286220,516248,757904,618284,569198,325660,525866,395192,910676,850209,966651,447004,960431,981546,95966,798422,266759,790651,259323,803327,634749,837768,650367,96905,959622,574395,490652,676669,659203,634825,448181,201689,102460,407954,718870,594825,271391,853951,456936,275332,405217,775537,75170,165486,179080,202557,323806,96746,795204,1078,803543,226224,99963,948077,316575,391911,322805,81434,659122,127542,394262,364335,229769,98653,686784,438528,71286,992608,627081,293107,532844,782871,739076,543227,885250,962993,808765,565248,560155,959432,379271,106273,917205,858103,779142,948847,206257,654116,562433,189691,42440,184403,271064,268742,910864,342643,906808,974979,965622,540325,651919,244675,419392,61824,954794,569432,720998,62728,153500,848469,715767,587057,936968,772225,59057,394243,557314,488193,691909,264514,488078,845283,322128,15401,545569,545791,873867,972483,282146,257820,512162,709138,154263,809909,505232,809033,421851,87055,46359,289611,141575,618076,439994,242532,139906,619293,35004,406934,592098,450666,721981,992555,721509,842201,192197,34157,853103,953657,938028,58546,809424,375588,487046,225447,515619,526900,119159,649450,672230,993244,166627,402254,742738,483739,829543,220527,498555,373041,259325,732307,927186,328091,798596,229714,852153,472251,995773,244578,48788,397248,886269,823339,796577,566174,828985,519310,836057,552000,791405,953928,980370,892899,412196,546131,63343,650931,189152,217923,517349,152773,307742,480833,433337,996992,1075,3};
    s[23] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,243688,17997,17997,529800,529800,971937,971937,647445,223674,622635,133196,336193,705853,956937,99300,755510,307427,132255,819353,557117,452398,372454,427702,219836,410893,568289,313826,660538,351941,102888,495935,866415,290245,379072,759013,157699,52652,843902,747387,697610,895317,944302,104338,893671,781534,231455,878389,478946,637815,111574,724890,903893,695106,585172,923827,311057,330366,161228,248461,86811,350881,872359,650528,259493,742789,478924,730999,656991,264777,717888,224261,891553,239101,639797,266307,2074,225286,674788,894569,29699,881647,451940,82228,326189,440045,426884,375188,698318,409542,411124,706136,207714,301978,564935,474900,593875,903821,547311,963306,736313,870124,799044,252450,928869,403442,829450,761152,212532,639121,788767,477200,661921,944808,339594,799845,69139,811324,291684,147773,605389,125000,596971,534800,964063,508162,511126,405064,147144,850426,238526,307923,536411,43800,306189,669410,99908,185247,668340,575853,983826,432876,734124,693588,787126,263189,865385,656020,378197,182160,932200,698076,550666,625721,424198,695805,541934,695408,634842,441244,455727,82527,472452,583853,705738,690467,145835,362260,139643,258727,869928,226957,446326,329882,916772,963995,288641,231035,164657,453821,837558,458837,614807,757358,796425,355756,433052,311506,943281,91083,628493,603581,509054,751368,998232,111758,898895,677240,276311,24137,977692,8256,857667,433448,915875,78027,554345,448349,487558,64697,554945,566424,473121,121117,929123,290888,607968,644499,71875,163076,879071,682053,566566,457081,893729,880546,411032,752254,568924,1308,374603,870928,932466,95500,889965,699307,967954,318576,38882,435151,121653,304930,481424,325955,891889,510810,379492,47006,663236,687030,154106,582198,357120,245005,588571,1255,1549,152809,311098,172307,779417,437703};
    c[24] = {549527,381850,889544,959538,27114,353714,337618,767246,883945,515825,687116,475594,114819,405010,624074,930174,323878,53995,318334,404772,656190,218314,844916,35440,590215,340799,646093,244226,975679,426530,516344,591114,982645,375784,562878,320883,932459,845549,525221,981539,460993,169983,173215,507502,836596,958670,485159,900233,531280,677554,654959,143946,758925,44850,269268,33851,487571,87136,595500,262198,9542,633522,473474,512690,613894,571326,533024,992391,96380,581688,972591,515746,620516,656929,180656,823405,375041,953066,295529,857170,852749,610576,367024,88196,585889,789284,193001,91881,322755,668550,812473,807775,400719,285028,297086,657153,222447,827264,202846,322705,548073,529955,464278,642434,871807,886643,901558,189683,229973,513032,965282,104220,191264,875072,285511,329804,815394,126924,694933,393179,965157,505266,316064,544702,323987,391009,249175,542995,12966,365839,589541,830004,375577,235418,427798,154574,654511,119667,402655,467621,386235,630852,304270,797741,727973,476983,489055,837463,150539,499481,722458,608562,749751,456899,626184,615544,557402,831503,117695,333193,338988,202487,870782,352874,771513,670558,508857,782471,295711,813633,553829,919588,752536,207544,611722,878918,586421,586774,740761,417683,836810,902385,34613,219865,685595,48146,386362,714070,967330,107984,522432,810007,366087,983595,605452,560638,870688,995084,857843,186119,277807,611065,201302,699306,165365,827771,819516,281932,641523,21899,292936,930487,143845,846825,779539,466275,877329,510418,941442,101875,562654,264828,966916,527835,986458,572675,548598,136040,148316,860987,461031,136534,530055,905885,428391,96994,149098,622477,134625,121279,171507,689703,405293,925605,376300,736947,245214,857741,324172,910698,455695,309893,403477,32891,193364,652736,666832,934725,447868,550358,998084,62572,434478,625795,872973,689270,780989,561026,241978,445942,722032,804559,755957,305631,469819,179945,150971,990396,320270,598035,86597,794288,706311,996629,122067,275244,525927,477120,476119,883606,415512,622307,34643,37704,752385,990524,768694,327696,996715,1170,3};
    s[24] = {1,1,3,3,19,19,283,283,7139,7139,235275,235275,931359,931359,243688,243688,17997,17997,529800,529800,971937,971937,647445,647445,46399,755829,958826,224908,475992,74244,614019,384395,829331,344359,901534,633852,570435,715582,902483,932293,966466,573021,55031,382169,463930,577217,386350,535317,977737,242367,236576,902730,658850,662743,307419,122597,641554,692337,902725,457210,587062,73750,643433,789998,176205,402171,834046,131972,279160,638856,316374,918979,670354,128362,310960,12086,364277,647576,722576,636624,824645,781720,224200,268497,561762,119287,571049,521024,445125,270402,13092,853733,715982,521813,434891,970066,944998,195738,60594,978483,912795,594549,796535,415279,763998,398004,509397,57034,453668,558282,92508,895893,25799,45674,486642,790810,428360,379634,578434,378112,420591,585368,681905,692528,994691,351387,337372,149638,256342,703512,302280,162863,431735,510940,365853,685920,793159,934778,452310,370961,299875,228585,194302,715463,331834,430718,468455,210715,928409,822926,208653,173176,976875,292587,986612,274253,800851,942834,118564,100907,981274,473676,70594,124364,795925,314109,696135,250781,375030,25732,853955,442310,331497,127538,921975,591569,398056,231547,54571,541222,545164,996649,259938,636852,498677,82249,233431,16287,354923,687461,581587,889424,447473,218896,948563,428786,934816,235813,366499,492972,465249,695283,823649,824637,356549,798036,122760,377368,942593,609670,410293,609753,280569,623618,159387,319274,612398,664931,988832,419438,482568,339687,424983,688607,147752,666702,551741,139513,813396,682887,787974,10674,46057,276730,241978,834307,197687,330283,582874,861692,932657,728015,78176,859599,146512,454931,35200,512584,815033,958028,241188,794105,247102,483888,14120,101654,715813,847935,500963,26652,162661,430889,983507,747544,575805,120778,738123,301870,38702,655659,167519,944069,724894,210342,737139,764182,151779,399956,930179,531021,329164,92346,913105,677944,720284,294618,933760,518841,338844,449675,905054,915126,582552,232357,19990,96294,732522,985842,305068,456817,415408};
    int t;
    cin >> t;
    while (t--) {
        long long n, k;
        cin >> n >> k;
        cout << solve(k, M, c[n], s[n]) << endl;
    }

    return 0;
}
